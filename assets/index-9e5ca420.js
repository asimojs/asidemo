(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const rn="modulepreload",on=function(e){return"/"+e},nt={},Je=function(t,n,r){if(!n||n.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=on(o),o in nt)return;nt[o]=!0;const a=o.endsWith(".css"),d=a?'[rel="stylesheet"]':"";if(!!r)for(let s=i.length-1;s>=0;s--){const y=i[s];if(y.href===o&&(!a||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${d}`))return;const _=document.createElement("link");if(_.rel=a?"stylesheet":rn,a||(_.as="script",_.crossOrigin=""),_.href=o,document.head.appendChild(_),a)return new Promise((s,y)=>{_.addEventListener("load",s),_.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};var Te,T,It,le,rt,jt,Fe,Se={},Tt=[],sn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,qe=Array.isArray;function se(e,t){for(var n in t)e[n]=t[n];return e}function Nt(e){var t=e.parentNode;t&&t.removeChild(e)}function Pe(e,t,n){var r,i,o,a={};for(o in t)o=="key"?r=t[o]:o=="ref"?i=t[o]:a[o]=t[o];if(arguments.length>2&&(a.children=arguments.length>3?Te.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)a[o]===void 0&&(a[o]=e.defaultProps[o]);return we(e,a,r,i,null)}function we(e,t,n,r,i){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++It};return i==null&&T.vnode!=null&&T.vnode(o),o}function Ne(e){return e.children}function ke(e,t){this.props=e,this.context=t}function fe(e,t){if(t==null)return e.__?fe(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?fe(e):null}function Et(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Et(e)}}function ot(e){(!e.__d&&(e.__d=!0)&&le.push(e)&&!Ce.__r++||rt!==T.debounceRendering)&&((rt=T.debounceRendering)||jt)(Ce)}function Ce(){var e,t,n,r,i,o,a,d;for(le.sort(Fe);e=le.shift();)e.__d&&(t=le.length,r=void 0,i=void 0,a=(o=(n=e).__v).__e,(d=n.__P)&&(r=[],(i=se({},o)).__v=o.__v+1,Ke(d,o,i,n.__n,d.ownerSVGElement!==void 0,o.__h!=null?[a]:null,r,a??fe(o),o.__h),Rt(r,o),o.__e!=a&&Et(o)),le.length>t&&le.sort(Fe));Ce.__r=0}function At(e,t,n,r,i,o,a,d,u,_){var s,y,v,h,g,I,x,P=r&&r.__k||Tt,V=P.length;for(n.__k=[],s=0;s<t.length;s++)if((h=n.__k[s]=(h=t[s])==null||typeof h=="boolean"||typeof h=="function"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?we(null,h,null,null,h):qe(h)?we(Ne,{children:h},null,null,null):h.__b>0?we(h.type,h.props,h.key,h.ref?h.ref:null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(v=P[s])===null||v&&h.key==v.key&&h.type===v.type)P[s]=void 0;else for(y=0;y<V;y++){if((v=P[y])&&h.key==v.key&&h.type===v.type){P[y]=void 0;break}v=null}Ke(e,h,v=v||Se,i,o,a,d,u,_),g=h.__e,(y=h.ref)&&v.ref!=y&&(x||(x=[]),v.ref&&x.push(v.ref,null,h),x.push(y,h.__c||g,h)),g!=null?(I==null&&(I=g),typeof h.type=="function"&&h.__k===v.__k?h.__d=u=Dt(h,u,e):u=Lt(e,h,v,P,g,u),typeof n.type=="function"&&(n.__d=u)):u&&v.__e==u&&u.parentNode!=e&&(u=fe(v))}for(n.__e=I,s=V;s--;)P[s]!=null&&(typeof n.type=="function"&&P[s].__e!=null&&P[s].__e==n.__d&&(n.__d=Ot(r).nextSibling),Vt(P[s],P[s]));if(x)for(s=0;s<x.length;s++)Ht(x[s],x[++s],x[++s])}function Dt(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t=typeof r.type=="function"?Dt(r,t,n):Lt(n,r,r,i,r.__e,t));return t}function Lt(e,t,n,r,i,o){var a,d,u;if(t.__d!==void 0)a=t.__d,t.__d=void 0;else if(n==null||i!=o||i.parentNode==null)e:if(o==null||o.parentNode!==e)e.appendChild(i),a=null;else{for(d=o,u=0;(d=d.nextSibling)&&u<r.length;u+=1)if(d==i)break e;e.insertBefore(i,o),a=o}return a!==void 0?a:i.nextSibling}function Ot(e){var t,n,r;if(e.type==null||typeof e.type=="string")return e.__e;if(e.__k){for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=Ot(n)))return r}return null}function cn(e,t,n,r,i){var o;for(o in n)o==="children"||o==="key"||o in t||Ie(e,o,null,n[o],r);for(o in t)i&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||n[o]===t[o]||Ie(e,o,t[o],n[o],r)}function it(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||sn.test(t)?n:n+"px"}function Ie(e,t,n,r,i){var o;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||it(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||it(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?ct:st,o):e.removeEventListener(t,o?ct:st,o);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function st(e){return this.l[e.type+!1](T.event?T.event(e):e)}function ct(e){return this.l[e.type+!0](T.event?T.event(e):e)}function Ke(e,t,n,r,i,o,a,d,u){var _,s,y,v,h,g,I,x,P,V,J,G,Z,B,X,j=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,d=t.__e=n.__e,t.__h=null,o=[d]),(_=T.__b)&&_(t);try{e:if(typeof j=="function"){if(x=t.props,P=(_=j.contextType)&&r[_.__c],V=_?P?P.props.value:_.__:r,n.__c?I=(s=t.__c=n.__c).__=s.__E:("prototype"in j&&j.prototype.render?t.__c=s=new j(x,V):(t.__c=s=new ke(x,V),s.constructor=j,s.render=ln),P&&P.sub(s),s.props=x,s.state||(s.state={}),s.context=V,s.__n=r,y=s.__d=!0,s.__h=[],s._sb=[]),s.__s==null&&(s.__s=s.state),j.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=se({},s.__s)),se(s.__s,j.getDerivedStateFromProps(x,s.__s))),v=s.props,h=s.state,s.__v=t,y)j.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(j.getDerivedStateFromProps==null&&x!==v&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(x,V),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(x,s.__s,V)===!1||t.__v===n.__v){for(t.__v!==n.__v&&(s.props=x,s.state=s.__s,s.__d=!1),s.__e=!1,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(H){H&&(H.__=t)}),J=0;J<s._sb.length;J++)s.__h.push(s._sb[J]);s._sb=[],s.__h.length&&a.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(x,s.__s,V),s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(v,h,g)})}if(s.context=V,s.props=x,s.__P=e,G=T.__r,Z=0,"prototype"in j&&j.prototype.render){for(s.state=s.__s,s.__d=!1,G&&G(t),_=s.render(s.props,s.state,s.context),B=0;B<s._sb.length;B++)s.__h.push(s._sb[B]);s._sb=[]}else do s.__d=!1,G&&G(t),_=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++Z<25);s.state=s.__s,s.getChildContext!=null&&(r=se(se({},r),s.getChildContext())),y||s.getSnapshotBeforeUpdate==null||(g=s.getSnapshotBeforeUpdate(v,h)),At(e,qe(X=_!=null&&_.type===Ne&&_.key==null?_.props.children:_)?X:[X],t,n,r,i,o,a,d,u),s.base=t.__e,t.__h=null,s.__h.length&&a.push(s),I&&(s.__E=s.__=null),s.__e=!1}else o==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=an(n.__e,t,n,r,i,o,a,u);(_=T.diffed)&&_(t)}catch(H){t.__v=null,(u||o!=null)&&(t.__e=d,t.__h=!!u,o[o.indexOf(d)]=null),T.__e(H,t,n)}}function Rt(e,t){T.__c&&T.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){T.__e(r,n.__v)}})}function an(e,t,n,r,i,o,a,d){var u,_,s,y=n.props,v=t.props,h=t.type,g=0;if(h==="svg"&&(i=!0),o!=null){for(;g<o.length;g++)if((u=o[g])&&"setAttribute"in u==!!h&&(h?u.localName===h:u.nodeType===3)){e=u,o[g]=null;break}}if(e==null){if(h===null)return document.createTextNode(v);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,v.is&&v),o=null,d=!1}if(h===null)y===v||d&&e.data===v||(e.data=v);else{if(o=o&&Te.call(e.childNodes),_=(y=n.props||Se).dangerouslySetInnerHTML,s=v.dangerouslySetInnerHTML,!d){if(o!=null)for(y={},g=0;g<e.attributes.length;g++)y[e.attributes[g].name]=e.attributes[g].value;(s||_)&&(s&&(_&&s.__html==_.__html||s.__html===e.innerHTML)||(e.innerHTML=s&&s.__html||""))}if(cn(e,v,y,i,d),s)t.__k=[];else if(At(e,qe(g=t.props.children)?g:[g],t,n,r,i&&h!=="foreignObject",o,a,o?o[0]:n.__k&&fe(n,0),d),o!=null)for(g=o.length;g--;)o[g]!=null&&Nt(o[g]);d||("value"in v&&(g=v.value)!==void 0&&(g!==e.value||h==="progress"&&!g||h==="option"&&g!==y.value)&&Ie(e,"value",g,y.value,!1),"checked"in v&&(g=v.checked)!==void 0&&g!==e.checked&&Ie(e,"checked",g,y.checked,!1))}return e}function Ht(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){T.__e(r,n)}}function Vt(e,t,n){var r,i;if(T.unmount&&T.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Ht(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){T.__e(o,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&Vt(r[i],t,n||typeof e.type!="function");n||e.__e==null||Nt(e.__e),e.__=e.__e=e.__d=void 0}function ln(e,t,n){return this.constructor(e,n)}function un(e,t,n){var r,i,o;T.__&&T.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,o=[],Ke(t,e=(!r&&n||t).__k=Pe(Ne,null,[e]),i||Se,Se,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?Te.call(t.childNodes):null,o,!r&&n?n:i?i.__e:t.firstChild,r),Rt(o,e)}Te=Tt.slice,T={__e:function(e,t,n,r){for(var i,o,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(e)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,r||{}),a=i.__d),a)return i.__E=i}catch(d){e=d}throw e}},It=0,ke.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=se({},this.state),typeof e=="function"&&(e=e(se({},n),this.props)),e&&se(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ot(this))},ke.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ot(this))},ke.prototype.render=Ne,le=[],jt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Fe=function(e,t){return e.__v.__b-t.__v.__b},Ce.__r=0;function ie(e){return{ns:e}}const at="service:",lt="object:",Oe="group:",Re=Promise.resolve(null);function Mt(e){let t=0;const n=new Map,r=new Map,i={registerService(d,u){n.set(at+d.ns,u)},registerFactory(d,u){n.set(lt+d.ns,u)},registerGroup(d,u){const _=Oe+ ++t,s=()=>{let y=r.get(_);return y||(y=a(u),r.set(_,y),y)};for(const y of d)n.set(Oe+y.ns,s)},get(...d){if(d.length===1){const u=d[0];return o(typeof u=="string"?u:u.ns)}return Promise.all(d.map(u=>o(typeof u=="string"?u:u.ns)))},createChildContext(){return Mt(i)}};return i;function o(d,u=!0){const _=at+d,s=r.get(_);if(s!==void 0)return s;const y=n.get(_);if(y){let v=a(y),h;const g=new Promise(I=>{h=I});return v.then(I=>{I&&(typeof I=="object"||typeof I=="function")?(r.set(_,I),h(I)):(r.set(_,Re),h(null))}),r.set(_,g),g}else{const v=n.get(lt+d);if(v)return a(v);if(u){const h=n.get(Oe+d);if(h)return a(h).then(()=>o(d,!1))}if(e)return e.get(d)}return Re}function a(d){let u=d();return u&&(typeof u=="object"||typeof u=="function")?typeof u.then!="function"&&(u=Promise.resolve(u)):u=Re,u}}const re=Mt(),Ut=ie("asidemo.services.NavService"),dn=ie("asidemo.services.FetchService"),pn=ie("asidemo.services.TeamStore"),fn=ie("asidemo.services.TasksStore");var _e,F,He,ut,je=0,zt=[],xe=[],dt=T.__b,pt=T.__r,ft=T.diffed,_t=T.__c,ht=T.unmount;function Xe(e,t){T.__h&&T.__h(F,e,je||t),je=0;var n=F.__H||(F.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:xe}),n.__[e]}function _n(e){return je=1,hn(Bt,e)}function hn(e,t,n){var r=Xe(_e++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Bt(void 0,t),function(d){var u=r.__N?r.__N[0]:r.__[0],_=r.t(u,d);u!==_&&(r.__N=[_,r.__[1]],r.__c.setState({}))}],r.__c=F,!F.u)){var i=function(d,u,_){if(!r.__c.__H)return!0;var s=r.__c.__H.__.filter(function(v){return v.__c});if(s.every(function(v){return!v.__N}))return!o||o.call(this,d,u,_);var y=!1;return s.forEach(function(v){if(v.__N){var h=v.__[0];v.__=v.__N,v.__N=void 0,h!==v.__[0]&&(y=!0)}}),!(!y&&r.__c.props===d)&&(!o||o.call(this,d,u,_))};F.u=!0;var o=F.shouldComponentUpdate,a=F.componentWillUpdate;F.componentWillUpdate=function(d,u,_){if(this.__e){var s=o;o=void 0,i(d,u,_),o=s}a&&a.call(this,d,u,_)},F.shouldComponentUpdate=i}return r.__N||r.__}function Ft(e,t){var n=Xe(_e++,3);!T.__s&&Wt(n.__H,t)&&(n.__=e,n.i=t,F.__H.__h.push(n))}function Gt(e){return je=5,mn(function(){return{current:e}},[])}function mn(e,t){var n=Xe(_e++,7);return Wt(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function vn(){for(var e;e=zt.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach($e),e.__H.__h.forEach(Ge),e.__H.__h=[]}catch(t){e.__H.__h=[],T.__e(t,e.__v)}}T.__b=function(e){F=null,dt&&dt(e)},T.__r=function(e){pt&&pt(e),_e=0;var t=(F=e.__c).__H;t&&(He===F?(t.__h=[],F.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=xe,n.__N=n.i=void 0})):(t.__h.forEach($e),t.__h.forEach(Ge),t.__h=[],_e=0)),He=F},T.diffed=function(e){ft&&ft(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(zt.push(t)!==1&&ut===T.requestAnimationFrame||((ut=T.requestAnimationFrame)||yn)(vn)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==xe&&(n.__=n.__V),n.i=void 0,n.__V=xe})),He=F=null},T.__c=function(e,t){t.some(function(n){try{n.__h.forEach($e),n.__h=n.__h.filter(function(r){return!r.__||Ge(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],T.__e(r,n.__v)}}),_t&&_t(e,t)},T.unmount=function(e){ht&&ht(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{$e(r)}catch(i){t=i}}),n.__H=void 0,t&&T.__e(t,n.__v))};var mt=typeof requestAnimationFrame=="function";function yn(e){var t,n=function(){clearTimeout(r),mt&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);mt&&(t=requestAnimationFrame(n))}function $e(e){var t=F,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),F=t}function Ge(e){var t=F;e.__c=e.__(),F=t}function Wt(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Bt(e,t){return typeof t=="function"?t(e):t}let pe;function vt(e){e.value=null,e.next=pe,pe=e}function yt(e,t){if(pe){const n=pe;return pe=n.next,n.value=e,n.next=t,n}}class We{constructor(){this._size=0}get head(){return this._head}get size(){return this._size}add(t){const n=this._head;let r=yt(t,n)||{value:t,next:n};return this._head=r,this._size++,r}insert(t){let n=this._head,r;if(!n)r=t()||void 0,r!==void 0&&this.add(r);else{let i;for(;i||n;){if(r=t(i==null?void 0:i.value,n==null?void 0:n.value)||void 0,r!==void 0){let o=yt(r,n)||{value:r,next:n};i?i.next=o:this._head=o,this._size++;return}i=n,n=n==null?void 0:n.next}}}peek(){return this._head?this._head.value:void 0}shift(){const t=this._head;if(t){const n=t.value;return this._head=t.next,this._size--,vt(t),n}}remove(t){let n=this._head,r=null;for(;n;){if(n.value===t)return r?(r.next=n.next,this._size--,vt(n)):this.shift(),!0;r=n,n=n.next}return!1}}var ee;(function(e){e.NotATraxObject="",e.Object="O",e.Array="A",e.Store="S",e.Processor="P"})(ee||(ee={}));const C=Object.freeze({Info:"!LOG",Warning:"!WRN",Error:"!ERR",CycleStart:"!CS",CycleComplete:"!CC",New:"!NEW",Dispose:"!DEL",Set:"!SET",Get:"!GET",ProcessorDirty:"!DRT",ProcessorSkipped:"!SKP",ProcessingStart:"!PCS",ProcessingPause:"!PCP",ProcessingResume:"!PCR",ProcessingEnd:"!PCE"});var gn=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function d(s){try{_(r.next(s))}catch(y){a(y)}}function u(s){try{_(r.throw(s))}catch(y){a(y)}}function _(s){s.done?o(s.value):i(s.value).then(d,u)}_((r=r.apply(e,t||[])).next())})};function bn(e,t,n){let r=0,i=1e3,o,a;const d=new Map,u=[];let _="None",s=-1,y=-1,v=null,h=0;function g(){return v===null&&(y=-1,s++,v=Promise.resolve().then(I),x(C.CycleStart)),y++,s+":"+y}function I(){X(),x(C.CycleComplete),v=null}function x(w){w===C.CycleComplete&&n&&n();const E=Date.now(),b=h!==0?E-h:0;h=E,M(w,{elapsedTime:b},e)}const P=1,V=2,J=3,G=new We;function Z(w){G.add(w)}function B(w){let E=G.shift();for(;E&&E!==w;)H("[trax/processing context] Contexts must be ended or paused before parent:",E.id),E=G.shift()}function X(){if(G.size!==0){let w=G.shift();for(;w;)H("[trax/processing context] Contexts must be ended or paused before cycle ends:",w.id),w=G.shift()}}function j(w,E){let b=P;const A=Object.assign({processId:w},E),$={get id(){return w},pause(){b!==P?H("[trax/processing context] Only started or resumed contexts can be paused:",w):(B($),M(C.ProcessingPause,A,e),b=V)},resume(){b!==V?H("[trax/processing context] Only paused contexts can be resumed:",w):(Z($),M(C.ProcessingResume,A,e),b=P)},end(){b===J?H("[trax/processing context] Contexts cannot be ended twice:",w):(B($),M(C.ProcessingEnd,A,e),b=J)}};return Z($),$}function H(...w){M(C.Error,Ve(w))}function M(w,E,b,A){let $;if(r>=i&&i>1?($=o,o=o.next,r--,$.id="",$.type="",$.next=$.data=$.parentId=void 0):$={id:"",type:""},kn(e,$,w,t,E,b),$.id=g(),$.parentId=A,$.type!==""){o===void 0?(o=a=$,r=1):(a.next=$,a=$,r++);for(const W of u)try{W({id:$.id,type:$.type,data:$.data})}catch{}oe($.type,$)}if(_!=="None"){const W=$.type;if(W!==C.CycleStart&&W!==C.CycleComplete&&(W!==C.Get||_==="All")){let te=xn($.type,$.data),Y="";$.parentId&&(Y=" - parent:"+$.parentId),console.log(`${$.id} ${$.type}${te?" - "+te:""}${Y}`)}}return $}function oe(w,E){const b=d.get(w);if(b){const A=b.filter($=>!$({id:E.id,type:E.type,data:E.data,parentId:E.parentId}));A.length===0?d.delete(w):d.set(w,A)}}return{get consoleOutput(){return _},set consoleOutput(w){_=w},event(w,E,b){M(w,E,b)},info(...w){M(C.Info,Ve(w))},warn(...w){M(C.Warning,Ve(w))},error:H,set maxSize(w){const E=i;if(w<0?i=-1:w<2?i=2:i=w,i>0&&i<E&&i<r){let b=r-i;for(;o&&b;)o=o.next,b--,r--}},startProcessingContext(w,E){let b=w.name;b.charAt(0)==="!"&&E!==e&&(H(`Processing Context name cannot start with reserved prefix: ${b}`),w.name=b.replace(/\!+/,""));const A=G.peek(),$=A?A.id:void 0,W=M(C.ProcessingStart,w,e,$);return j(W.id,w)},get maxSize(){return i},get size(){return r},scan(w){let E=o,b=!0;for(;b&&E;)try{w(E)===!1&&(b=!1),E=E.next}catch{}},lastEvent(){return a},awaitEvent(w,E){return gn(this,void 0,void 0,function*(){if(w===""||w==="*")return M(C.Error,`[trax/eventStream.await] Invalid event type: '${w}'`),{id:a.id,type:a.type,data:a.data};let b=d.get(w);b===void 0&&(b=[],d.set(w,b));let A,$=new Promise(W=>{A=W});return b.push(W=>wn(W,E)?(A(W),!0):!1),$})},subscribe(w,E){let b;return w==="*"?b=A=>E(A):b=A=>{A.type===w&&E(A)},u.push(b),b},unsubscribe(w){const E=u.indexOf(w);return E>-1?(u.splice(E,1),!0):!1}}}function wn(e,t){if(t===void 0||e.data===void 0)return!0;const n=JSON.parse(e.data);if(typeof t!="object"&&t!==null)return n===t;if(t!==null&&n!==null&&typeof n=="object"){for(const r of Object.keys(t)){const i=n[r],o=t[r];if(o instanceof RegExp)if(typeof i=="string"){if(i.match(o)===null)return!1}else return!1;else if(i!==t[r])return!1}return!0}return!1}function Ve(e){let t="";const n=[];for(let r of e){const i=typeof r;i==="string"||i==="number"||i==="boolean"||r===null?t?t+=" "+r:t=""+r:(t&&(n.push(t),t=""),n.push(r))}if(t&&n.push(t),n.length!==0)return n.length===1?n[0]:n}function kn(e,t,n,r,i,o){let a=!1,d="";if(n==="")a=!0,d="Event type cannot be empty";else if(n.charAt(0)==="!"&&o!==e&&n!==C.Error&&n!==C.Warning&&n!==C.Info)a=!0,d="Event type cannot start with reserved prefix: "+n;else if(t.type=n,i!==void 0)try{r?t.data=r(i):t.data=JSON.stringify(i)}catch(u){a=!0,d="Event strinfication error: "+u}else i=void 0;a&&(t.type=C.Error,t.data=d)}function xn(e,t){if(!t||!e||e.charAt(0)!=="!")return t;try{const n=JSON.parse(""+t);if(e===C.CycleStart||e===C.CycleComplete)return"0";if(e===C.Info||e===C.Warning||e===C.Error)return`${t.replace(/"/g,"")}`;if(e===C.ProcessingPause||e===C.ProcessingResume||e===C.ProcessingEnd)return`${JSON.parse(t).processId}`;if(e===C.ProcessingStart){const r=n;if(r.name==="!StoreInit")return`${r.name} (${r.storeId})`;if(r.name==="!Compute"){const i=r.isRenderer?" R":"";return`${r.name} #${r.computeCount} (${r.processorId}) P${r.processorPriority} ${r.trigger}${i}`}else return r.name==="!Reconciliation"?`${r.name} #${r.index} - ${r.processorCount} processor${r.processorCount!==1?"s":""}`:r.name==="!ArrayUpdate"?`${r.name} (${r.objectId})`:`${r.name}`}else if(e===C.New){const r=n;return r.objectId===void 0?t:`${r.objectType}: ${r.objectId}`}else if(e===C.Dispose){const r=n;return r.objectId===void 0?t:`${r.objectId}`}else if(e===C.Get){const r=n;return`${r.objectId}.${r.propName} -> ${Me(r.propValue)}`}else if(e===C.Set){const r=n;return`${r.objectId}.${r.propName} = ${Me(r.toValue)} (prev: ${Me(r.fromValue)})`}else if(e===C.ProcessorDirty){const r=n;return`${r.processorId} <- ${r.objectId}.${r.propName}`}else if(e===C.ProcessorSkipped)return`${n.processorId}`}catch{}return t}function Me(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="object"){const t=z(e);return t?t.id:JSON.stringify(e)}else return typeof e=="string"?"'"+e.replace(/\'/g,"\\'")+"'":""+e}function gt(){}function Be(e,t,n,r=gt,i=gt){let o=null,a,d,u,_;return(...h)=>{r(),o=t();let g,I=!0;a=void 0;let x;try{x=e(...h),x&&x.next&&typeof x.next=="function"?(a=x,g=x.next(),I=!!g.done):x&&typeof x=="object"&&typeof x.then=="function"&&typeof x.catch=="function"&&x.catch(P=>{n(P)})}catch(P){n(P)}return i(I),I?(o.end(),o=null):(o.pause(),s(g,a)),a!==void 0?(d&&_&&_("Processing Cancelled"),d=u=_=void 0,I?Promise.resolve(x):(d=new Promise((P,V)=>{u=P,_=V}),d)):x};function s(h,g){if(h&&!h.done){const I=h.value,x=P=>{n(P)};I&&I.then?I.then(P=>{y(P,g)}).catch(x):Promise.resolve().then(()=>{y(I,g)}).catch(x)}}function y(h,g){if(g!==a||!o)return;if(r()===!1){v();return}o.resume();let I,x=!0;try{I=g.next(h),x=!!I.done}catch(P){n(P),x=!0,_&&_(P),v()}i(x),x?(o.end(),u&&u(I.value)):(o.pause(),s(I,g))}function v(){u=_=void 0}}function $n(e,t,n,r,i,o,a,d,u,_,s=!0,y=!1){let v=0,h=-1,g=!0,I=!1,x=!1,P=new Set,V=new Set,J,G=-1,Z="DirectCall",B;function X(b){a({type:C.Error,data:b})}let j,H;w(r);const M={get id(){return e},get target(){return u},get reconciliationId(){return G},get autoCompute(){return s},get priority(){return n},get computeCount(){return v},get dirty(){return g},get isRenderer(){return y},get disposed(){return I},get dependencies(){return I?[]:Array.from(P).sort()},onDirty:null,notifyChange(b,A){if(I||x)return!1;if(!g&&P.has(oe(b,A))){if(g=!0,a({type:C.ProcessorDirty,processorId:e,objectId:b,propName:A}),this.onDirty)try{this.onDirty()}catch($){X(`(${e}) onDirty callback execution error: ${$}`)}return!0}return!1},registerDependency(b,A,$){!x||I||$==="then"&&b.then===void 0||(P.add(oe(A,$)),V.add(A),Nn(M,z(o(A))))},compute(b=!1,A="DirectCall",$=-1){var W;if(I||!b&&!s&&(A==="Init"||A==="Reconciliation"))return;let te=!0;if(u!==null&&A!=="TargetRead"&&(te=((W=z(u))===null||W===void 0?void 0:W.hasExternalPropListener)||!1),te&&g||b){g=!1,P.clear(),J=V,V=new Set,v++,G=$,Z=A,H&&(w(H),H=void 0),B={processorId:e,processorName:t,computeCount:v,maxComputeCount:h};let Y;u!==null?Y=j(u,B):Y=j(B),Y&&typeof Y=="object"&&typeof Y.catch=="function"&&Y.catch(()=>{}),s&&P.size===0&&X(`(${e}) No dependencies found: processor will never be re-executed`)}else te||a({type:C.ProcessorSkipped,processorId:e})},updateComputeFn(b){H=b},dispose(){if(I)return!1;I=!0,x=!1,_&&_(e);for(const b of V)$t(M,z(o(b)));return a({type:C.Dispose,objectId:e}),!0}};return a({type:C.New,objectId:e,objectType:ee.Processor}),M.compute(!1,"Init"),M;function oe(b,A){return b+"."+A}function w(b){j=Be(b,()=>d({type:"!PCS",name:"!Compute",processorId:e,processorPriority:n,trigger:Z,isRenderer:y,computeCount:v}),A=>{X(`(${e}) Compute error: ${A}`)},()=>(x=!0,i.add(M),I?!1:void 0),A=>{x=!1,i.shift(),h=(B==null?void 0:B.maxComputeCount)||-1,A&&h>-1&&v>=h?M.dispose():E()})}function E(){if(J){for(const b of J)V.has(b)||$t(M,z(o(b)));J=void 0}}}var Sn=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function d(s){try{_(r.next(s))}catch(y){a(y)}}function u(s){try{_(r.throw(s))}catch(y){a(y)}}function _(s){s.done?o(s.value):i(s.value).then(d,u)}_((r=r.apply(e,t||[])).next())})};const Ye=new WeakMap,he=Symbol("trax.proxy.target"),bt=Symbol("trax.dict.size"),wt=/(\/|\>|\.|\%)/g,ye="root",Pn=":",Cn="*",In="-",jn="$",kt="$",Ue="%",xt=">",Tn="/",ge="☆trax.dictionary.size☆";function Nn(e,t){t&&(t.propListeners||(t.propListeners=new Set),t.propListeners.add(e),t.contentProcessors!==void 0&&!t.hasExternalPropListener&&(!e.target||z(e.target)!==t)&&(t.hasExternalPropListener=!0))}function $t(e,t){if(t&&t.propListeners)if(t.propListeners.delete(e),t.propListeners.size===0)t.propListeners=void 0,t.hasExternalPropListener=!1;else if(t.contentProcessors){let n=!1;for(const r of t.propListeners)!n&&(!r.target||z(r.target)!==t)&&(n=!0);t.hasExternalPropListener=n}else t.hasExternalPropListener=!1}function z(e){return e?Ye.get(e[he]||e):void 0}function be(e,t,n,r){const i={id:t,type:n,storeId:r,propListeners:void 0,computedProps:void 0,computedContent:void 0,awLevel:void 0,dictSize:void 0,contentProcessors:void 0,hasExternalPropListener:!1,lastContentProcessorCheck:-1};return Ye.set(e[he]||e,i),i}function En(e){Ye.delete(e[he]||e)}function An(){const e={};let t=0;const n=new Map,r=new Map,i=new Map,o=new Map,a=Array.isArray;let d=0,u=0,_=new We,s=new We,y=0;const v=bn(e,c=>JSON.stringify(c,(l,p)=>{if(typeof p=="object"){const k=z(p);return k?`[TRAX ${k.id}]`:p}else if(typeof p=="function")return"[Function]";return p}),()=>{E(),g.processChanges()});let h=!1;const g={log:v,createStore(c,l){return Y(c,"",l)},get pendingChanges(){return s.size>0},processChanges(){if(s.size>0){y++;const c=M({type:"!PCS",name:"!Reconciliation",index:y,processorCount:u});let l=s.shift();for(;l;)l.reconciliationId===y?j(`(${l.id}) Circular reference: Processors cannot run twice during reconciliation`):l.compute(!1,"Reconciliation",y),l=s.shift();c.end()}},reconciliation(){return Sn(this,void 0,void 0,function*(){const c=v.lastEvent();c&&c.type!==C.CycleComplete&&(yield v.awaitEvent(C.CycleComplete))})},isTraxObject(c){return z(c)!==void 0},getTraxId(c){var l;return((l=z(c))===null||l===void 0?void 0:l.id)||""},getTraxObjectType(c){var l;return((l=z(c))===null||l===void 0?void 0:l.type)||ee.NotATraxObject},getProcessor(c){return i.get(c)},getStore(c){return n.get(c)},getData(c){return b(c)||void 0},getActiveProcessor(){return _.peek()},updateArray(c,l){if(!a(c)||!a(l)){j("updateArray: Invalid argument (array expected)");return}const p=I(c),k=M({type:C.ProcessingStart,name:"!ArrayUpdate",objectId:p}),f=c.length,D=l.length;for(let L=0;D>L;L++)c[L]=l[L];if(D<f){for(let L=D;f>L;L++)c[L]=void 0;c.splice(D,f-D)}k.end()},updateDictionary(c,l){if(c===null||typeof c!="object"){j("updateDictionary: Invalid argument (object expected)");return}const p=I(c),k=M({type:C.ProcessingStart,name:"!DictionaryUpdate",objectId:p}),f=g.getObjectKeys(c),D=g.getObjectKeys(l);for(const L of f)D.includes(L)||delete c[L];for(const L of D)c[L]=l[L];k.end()},getObjectKeys(c){return z(c)?c[bt]?Object.keys(c):[]:Object.keys(c)}};function I(c){const l=z(c);if(l){X(l);const p=_.peek();return p&&(l.computedContent?p.id!==l.computedContent&&j(`Computed content conflict: ${l.id} can only be changed by ${l.computedContent}`):l.computedContent=p.id),l.id}return""}const x={get(c,l){const p=z(c);if(l===he)return c;if(l!=="toJSON"){if(typeof l=="string"){let k,f=!1;if(p){const D=_.peek();D&&D.registerDependency(c,p.id,l),w(p),f=l!=="then"&&l!=="constructor"||k!==void 0,c[l]!==void 0&&(k=c[l]=P(c[l],l,p)),f&&H({type:"!GET",objectId:p.id,propName:l,propValue:k})}else k=c[l];return k}else if(l===bt&&p){let k=p.dictSize;k===void 0&&(p.dictSize=k=Object.keys(c).length);const f=_.peek();return f&&f.registerDependency(c,p.id,ge),w(p),H({type:"!GET",objectId:p.id,propName:ge,propValue:k}),k}return c[l]}},set(c,l,p){if(typeof l!="symbol"){const k=c[l],f=z(c);if(f){const D=_.peek();if(X(f),D){let L=f.computedContent||void 0;if(!f.computedContent){let q=f.computedProps;q||(q=f.computedProps={}),L=q[l],L||(q[l]=D.id)}L&&L!==D.id&&(f.computedContent?j(`Computed content conflict: ${f.id}.${l} can only be set by ${L}`):j(`Computed property conflict: ${f.id}.${l} can only be set by ${L}`),p=k)}else f.computedContent&&(j(`Computed content conflict: ${f.id}.${l} can only be set by ${f.computedContent}`),p=k);if(k!==p){let L=!1,q=!1;if(a(c)){const ce=c.length;p=c[l]=P(p,""+l,f),L=c.length!==ce}else{p=c[l]=P(p,""+l,f);const ce=f.dictSize;if(k===void 0&&ce!==void 0){const me=Object.keys(c).length;me!==ce&&(f.dictSize=me,q=!0)}}H({type:"!SET",objectId:f.id,propName:l,fromValue:k,toValue:p}),typeof l=="string"&&oe(f,l),L&&oe(f,"length"),q&&oe(f,ge)}}else c[l]=p}return!0},deleteProperty(c,l){if(typeof l=="string"&&l in c){const p=z(c);return p&&p.dictSize&&(p.dictSize--,oe(p,ge)),delete c[l],!0}return!1}};function P(c,l,p){if(c!=null&&typeof c=="object"){if(c[he])return c;let k=z(c);if(k)return c;let f=0;if(l[0]===kt){let D=0,L=l.length;for(;D<L&&l[D]===kt;)f++,D++}else p.awLevel&&(f=p.awLevel);if(f!==1&&!k&&(c=V(p.id+Cn+l,c,p.storeId,!0),f&&f>1)){let D=z(c);D&&!D.awLevel&&(D.awLevel=f-1)}}return c}function V(c,l,p,k=!1){const f=b(c);if(f)if(l&&k){const q=c;for(;t++,c=q+jn+t,!!r.get(c););}else return f;let D;a(l)?D=be(l,c,ee.Array,p):D=be(l,c,ee.Object,p),H({type:"!NEW",objectId:c,objectType:D.type});const L=new Proxy(l,x);return A(c,L,p),L}return g;function J(c){const l=c.priority;s.insert((p,k)=>{if(!k||l<=k.priority)return c})}function G(c,l){let p="";if(a(c)?p=c.map(k=>{if(typeof k=="object"){const f=z(k);if(f){const D=f.id;if(l){const L=l.length+1;if(D.length>L&&D.slice(0,L)===l+"/")return D.slice(L)}return D.replace(/\//g,In)}else return j("Invalid id param: not a trax object"),Z()}return""+k}).join(Pn):p=c,p.match(wt)){const k=p.replace(wt,"");j(`Invalid trax id: ${p} (changed into ${k})`),p=k}return p}function Z(){return""+Math.floor(Math.random()*1e5)}function B(c,l,p){let k=G(c,l);return p?l+Ue+k:l+Tn+k}function X(c,l){if(c){p(c.computedContent)&&(c.computedContent=void 0);const k=c.computedProps;k&&l&&p(k[l])&&(k[l]=void 0)}function p(k){return!!(k&&!i.has(k))}}function j(c){v.error("[TRAX] "+c)}function H(c){c.type===C.Error?j(""+c.data):c.type===C.Info?v.info(""+c.data):v.event(c.type,c,e)}function M(c){return v.startProcessingContext(c,e)}function oe(c,l){const p=c.propListeners;if(p)for(const k of p)k.notifyChange(c.id,l)&&J(k)}function w(c){if(c.lastContentProcessorCheck!==y&&(c.lastContentProcessorCheck=y,c.contentProcessors))for(const l of c.contentProcessors)l.compute(!1,"TargetRead")}function E(){!h&&globalThis.__TRAX_DEVTOOLS__&&(h=!0,console.log("[Trax] DevTools detected"),globalThis.__TRAX_DEVTOOLS__.connectTrax(g))}function b(c){const l=r.get(c);return l&&l.deref()||null}function A(c,l,p){r.set(c,new WeakRef(l)),W(c,p)}function $(c,l,p){if(l&&En(l),p){if(p.contentProcessors){for(const k of p.contentProcessors)k.dispose();p.contentProcessors=void 0}te(c,p.storeId)}return H({type:"!DEL",objectId:c}),r.delete(c)}function W(c,l){let p=o.get(l);p||(p=new Set,o.set(l,p)),p.add(c)}function te(c,l){let p=o.get(l);p&&p.delete(c)}function Y(c,l,p,k){const f=Qe(c,l,!0);let D,L=!0,q=!1;const ce=M({type:"!PCS",name:"!StoreInit",storeId:f}),me=typeof p=="function"?p:S=>{S.init(p)},ve={get id(){return f},get root(){return D},get disposed(){return q},createStore(S,N){const O=Y(S,f,N,Yt);return W(O.id,f),O},init(S,N){return L?D=De(ye,S,!0,N):j(`(${f}) Store.init can only be called during the store init phase`),D},add(S,N,O){return De(S,N,!1,O)},get(S){const N=B(S,f,!1);return b(N)||void 0},remove(S){const N=z(S);let O="";if(N)if(O=N.id,N.type===ee.Processor)j(`(${O}) Processors cannot be disposed through store.remove()`);else if(N.type===ee.Store)j(`(${O}) Stores cannot be disposed through store.remove()`);else if(O.slice(f.length+1)===ye)j(`(${O}) Root objects cannot be disposed through store.remove()`);else return $(O,S,N);return!1},compute(S,N,O,R){let U=B(S,f,!0);return et(U,"",N,null,O,R)},getProcessor(S){const N=B(S,f,!0);return i.get(N)},getStore(S){const N=Qe(S,f,!1);return n.get(N)},dispose(){return Ae()},async(S,N){let O="[ASYNC]",R;typeof S=="string"?(O=S,R=N):R=S;const U=Be(R,()=>v.startProcessingContext({name:f+"."+O+"()",storeId:f}),K=>{j(`(${f}.${O}) error: ${K}`)});return U.updateAsyncName=K=>{O=K},U}};be(ve,f,ee.Store,""),H({type:"!NEW",objectId:f,objectType:ee.Store}),n.set(f,ve);function Ae(){if(q)return!1;n.delete(f),q=!0,k&&k(f);const S=o.get(f);if(S){o.delete(f);const N=f.length;let O,R;for(const U of S)R=void 0,O=U.charAt(N),O===xt?(R=n.get(U),R&&R.dispose()):O===Ue?(R=i.get(U),R&&R.dispose()):$(U)}return H({type:"!DEL",objectId:f}),!0}function Yt(S){te(S,f)}function Zt(S){i.delete(S)&&(u--,te(S,f))}function Qt(S){const N=S;for(const O of Object.keys(N))if(typeof N[O]=="function"){const R=N[O];typeof R.updateAsyncName=="function"?R.updateAsyncName(O):N[O]=Be(R,()=>v.startProcessingContext({name:f+"."+O+"()",storeId:f}),U=>{j(`(${f}.${O}) error: ${U}`)})}}let ne;try{ne=me(ve),L=!1,ne!==void 0&&(ne!==null&&typeof ne=="object"?Qt(ne):(j(`createStore init function must return a valid object (${f})`),ne={}))}catch(S){j(`createStore init error (${f}): ${S}`),ne={}}if(L=!1,en(),ne===void 0)return ce.end(),ve;const ae=ne;if(typeof ae.dispose=="function"){const S=ae.dispose;ae.dispose=()=>{S.call(ne),Ae()}}else ae.dispose=Ae;return ae.id&&j(`Store id will be overridden and must not be provided by init function (${f})`),ae.id=f,ce.end(),ae;function en(){D==null&&(j(`(${f}) createStore init must define a root object - see also: init()`),D=De(ye,{},!0))}function tn(){return q?(j(`(${f}) Stores cannot be used after being disposed`),!1):!0}function Qe(S,N,O=!0){let R=G(S);N!==""&&(R=N+xt+R);let U="";if(O){let K=n.get(R),Q=0;for(;K;)U=""+ ++Q,K=K=n.get(R+U)}return R+U}function De(S,N,O,R){let U=G(S,f);if(O||U===ye&&(j("Store.add: Invalid id 'root' (reserved)"),U=Z()),tn()){(N==null||typeof N!="object")&&(j(`(${f}) Store.add(${S}): Invalid init object parameter: [${typeof N}]`),N={});const K=V(B(U,f,!1),N,f);if(R!==void 0){const Q=z(K),tt=[];for(const Le of Object.getOwnPropertyNames(R)){const nn=`${f}${Ue}${U}[${Le}]`;tt.push(et(nn,Le,R[Le],K,!0,!1))}Q.contentProcessors=tt}return K}else return N}function et(S,N,O,R,U,K){let Q=i.get(S);return Q?(Q.updateComputeFn(O),Q):(d++,u++,Q=$n(S,N,d,O,_,b,H,M,R,Zt,U,K),be(Q,S,ee.Processor,f),i.set(S,Q),W(S,f),Q)}}}const de=An(),St="Preact",Pt=new Map;let Dn=0;function Ln(e,t){return e+":"+t}function On(){return de.getStore(St)||de.createStore(St,{})}let Rn=On();function Hn(e,t,n,r){n.jsx="";let i=Pt.get(e);i===void 0?i=1:i++,Pt.set(e,i);const o=Ln(e,i);n.id=o;const a=Rn.compute(o,()=>{try{n.jsx=t(n.props)}catch(d){de.log.error(`[@traxjs/trax-preact] Processing Error: ${d}`)}},!1,!0);a.onDirty=()=>{queueMicrotask(()=>r(++Dn))},n.processor=a}function Ee(e,t){function n(o){const[a,d]=_n(0),u=Gt({}).current;return u.processor||Hn(e,t,u,d),Ft(()=>function(){u.processor&&(u.processor.dispose(),u.processor=void 0)},[u]),u.props=o,u.processor.compute(!0),u.jsx}const r=e.replace(/\:/g,"_"),i=new Function("fc",`return function ${r}(props){ return fc(props) }`);return Un(i(n))}function Vn(){var e;return((e=de.getActiveProcessor())===null||e===void 0?void 0:e.id)||""}function Mn(e,...t){const n=Gt({}).current;let r=n.store;return r||(n.store=r=e(...t)),typeof r.dispose=="function"&&Ft(()=>()=>{r==null||r.dispose()},[r]),r}function Jt(e){return Mn(()=>{const t="State["+Vn().replace(/(^[^\/\%]+(\/|\%))|(%)/g,"")+"]";return de.createStore(t,e)}).root}function Un(e,t){function n(i){let o=this.props.ref,a=o===i.ref;return!a&&o&&(o.call?o(null):o.current=null),t?!t(this.props,i)||!a:zn(this.props,i)}function r(i){return this.shouldComponentUpdate=n,Pe(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r._forwarded=!0,r}function zn(e,t){for(let n in e)if(n!=="__source"&&!(n in t))return!0;for(let n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function rr(e){const t=Jt({ready:!1,promise:null,value:null});return qt(t,e)}function qt(e,t){if(!e.ready&&e.value)return e.ready=!0,e;if(e.ready=!1,e.promise===null)try{const n=e.promise=t();n&&typeof n.then=="function"?n.then(r=>{e.ready=!0,e.value=r,e.promise=null}):(e.ready=!0,e.value=n,e.promise=null)}catch(n){console.error(`[useAsyncRes] Error while calling factory: ${n}`),e.promise=null,e.ready=!1}return e}function Fn(e){const t=Jt({states:{},res:null});if(t.res===null){const n=t.states,r={};Object.getOwnPropertyNames(e).forEach(i=>{r[i]=()=>{let o=n[i];return o||(n[i]={ready:!1,promise:null,value:null},o=n[i]),qt(o,e[i])}}),t.res=r}return t.res}const Kt=ie("asidemo.views.teamview"),Xt=ie("asidemo.views.tasksview");var Gn=0;function m(e,t,n,r,i,o){var a,d,u={};for(d in t)d=="ref"?a=t[d]:u[d]=t[d];var _={type:e,props:u,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--Gn,__source:i,__self:o};if(typeof e=="function"&&(a=e.defaultProps))for(d in a)u[d]===void 0&&(u[d]=a[d]);return T.vnode&&T.vnode(_),_}const Wn=Ee("HomeView",({ns:e})=>{const t="list-['-'] ms-2 ps-3";return m("div",{class:"home-view pe-16 max-w-6xl pb-9",children:[m("p",{children:["This mini-application demonstrates how to architecture a web application with ",m("a",{class:"link em",href:"https://github.com/asimojs/asimo",target:"_blank",children:"asimo"})," in order to",m("em",{children:" keep the application startup fast"}),", independently from the number of application modules, and",m("em",{children:" build a mock environment"})," that can be used during the application development but also for demos and automated integration tests."]}),m("h2",{class:"pt-4 pb-2 text-lg font-medium",children:"Application startup"}),m("p",{children:["One of the main problems of ",m("a",{class:"link em",href:"https://en.wikipedia.org/wiki/Single-page_application",children:"SPA"})," applications is that their startup get slower when new features keep being added. Even though web browsers support ",m("a",{class:"link em",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import",children:"dynamic imports"})," that technically allow to progressively load the application piece by piece, the problem is that splitting an existing code base into efficient bundles is a very difficult task once the application is already implemented."]}),m("p",{class:"mt-2",children:[m("a",{class:"link em",href:"https://github.com/asimojs/asimo",target:"_blank",children:"Asimo"})," solves this problem by decoupling interfaces from their implementations and ",m("em",{children:"loading dependencies on-demand, asynchronously"}),". Code entities depend on typescript interfaces, but rely on asimo to import the actual implementation so that code entities don't drag their entire dependency tree when they are imported in a give file. This allows asimo bundles to be defined separately, and independently from the code structure (in other words bundles can be re-defined once the application has been implemented, according to the application usage)."]}),m("p",{class:"mt-2",children:["In this demo the application is split in ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/main/src/bundles.ts",children:"3 bundles"}),":",m("ul",{children:[m("li",{class:t,children:["the ",m("em",{children:"core bundle"})," that contains the main application files that need to be systematically loaded (e.g. the application framework or the navigation service that determines which view is displayed according to the URL)"]}),m("li",{class:t,children:["the ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/main/src/bundles/teamBundle.ts",children:"team bundle"})," that gathers the files that need to be loaded when the Team view is requested"]}),m("li",{class:t,children:["the ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/main/src/bundles/tasksBundle.ts",children:"tasks bundle"})," that gathers the files used by the Tasks view"]})]})]}),m("p",{class:"mt-2",children:["The application also exposes 3 entry points (aka. routes):",m("li",{class:t,children:["the ",m("a",{class:"link em",href:"./",children:"/"})," home page, that only loads the core bundle"]}),m("li",{class:t,children:["the ",m("a",{class:"link em",href:"./team",children:"/team"})," page, that loads the core bundle and the team bundle"]}),m("li",{class:t,children:["the ",m("a",{class:"link em",href:"./tasks",children:"/tasks"})," page, that loads the core bundle and the tasks bundle"]})]}),m("p",{class:"mt-2",children:["Then navigating to other views will transparently load the missing bundles, until all bundles are loaded. This can be easily validated through the Network tab in the Dev. tools:",m("div",{class:"flex justify-center py-8",children:m("img",{src:"./imgs/devtools.jpg",class:"w-10/12 max-w-[600px]"})})]}),m("h2",{class:"pt-4 pb-2 text-lg font-medium",children:"Mock Environment"}),m("p",{children:"Like any dependency-injection mechanism, asimo can replace core services with mock implementations. However, as asimo retrieves dependencies asynchronously, it can also dynamically load a mock environment."}),m("p",{class:"mt-2",children:["This is what is implemented in this demo: when the url contains a ",m("em",{children:"me"})," parameter (for Mock Environment), the application loads a mock service and initializes it with the profile id passed as parameter value:",m("div",{class:"flex justify-center py-8",children:m("img",{src:"./imgs/mockenvtrigger.jpg",class:"w-10/12 max-w-[600px]"})}),"The mock environment will then ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/29fc43bd2c5d4b95d45054ad2e66135976bf8e4e/src/mockenv/index.ts#L32",children:"override the fetch service"})," that wraps the browser fetch API in order to dynamically ",m("em",{children:"mock fetch responses"})," and work without any server."]}),m("p",{class:"mt-2",children:["This approach offers many benefits:",m("ul",{children:[m("li",{class:t,children:[" on the contrary to static mock techniques, ",m("em",{children:"this approach is dynamic"}),", which means that ",m("em",{children:"mocks can easily integrate values from previous actions"})," (this is because the mock service can keep a state in memory and use it to build mock responses - like in this ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/29fc43bd2c5d4b95d45054ad2e66135976bf8e4e/src/mockenv/fetch.ts#L10",children:"example"}),"). This comes in handy to handle advanced cases where multiple responses need to use common objects or identifiers (e.g. an asymmetric architecture with REST apis and SSE events that need to reference the same resource ids)."]}),m("li",{class:t,children:[m("em",{children:"multiple profiles can be supported"})," - which is convenient to test edge cases (like very small or very large data sets, long names, etc.). This demo implements two different profiles (cf. ",m("a",{class:"link em",href:"./tasks?me=1",children:"/tasks?me=1"})," or  ",m("a",{class:"link em",href:"./team?me=2",children:"/team?me=2"})," that uses a very long team name)"]}),m("li",{class:t,children:["the ",m("em",{children:"mocks are easy to maintain"})," as they use the same types exposed by the server APIs - so any change in the APIs result in typesript compilation error in the mock environment. Besides mocks can also be easily derived from each other, which also reduces the maintainance complexity"]}),m("li",{class:t,children:["the ",m("em",{children:"mocks can be used for automated tests"})," as shown in this ",m("a",{class:"link em",href:"https://github.com/asimojs/asidemo/blob/main/src/services/__tests__/teamstore.spec.ts",children:"service unit test"})]})]})]}),m("p",{class:"mt-36 italic",children:["Feel free to visit the ",m("a",{class:"link",href:"https://github.com/asimojs/asidemo",children:"project page"})," to get into the implementation details..."]})]})}),Bn=Ee("MainLayout",({ns:e})=>{const t=e.data,n=Fn({teamView:()=>re.get(Kt),tasksView:()=>re.get(Xt)});return m("div",{className:"main-layout flex h-full min-h-screen",children:[m("div",{className:"w-1/5 min-h-full max-w-xs min-w-fit",children:m(Jn,{ns:e})}),m("div",{className:"relative flex-1 px-7",children:[m("div",{className:"logo absolute w-full max-w-6xl",children:m("div",{class:"absolute top-10 right-20 text-fuchsia-950",children:m(qn,{size:42})})}),m("div",{class:"pt-56",children:t.view==="404"?m("div",{children:[" Invalid page: ",t.invalidPath404," "]}):t.view==="tasks"?n.tasksView().ready?Pe(n.tasksView().value,{ns:e}):"":t.view==="team"?n.teamView().ready?Pe(n.teamView().value,{ns:e}):"":t.view==="loading"?m("div",{children:" Loading... "}):m(Wn,{ns:e})})]})]})}),Jn=Ee("NavBar",({ns:e})=>{const t=e.data.view,n=[{text:"Home",view:""},{text:"Team",view:"team"},{text:"Task list",view:"tasks"}],r="block font-semibold cursor-default ",i="block text-fuchsia-300 cursor-pointer";return m("div",{className:"navbar bg-fuchsia-950 text-white h-full px-7",children:[m("h1",{class:"title pt-36 text-2xl",children:"Asimo Demo"}),m("div",{class:"pt-12",children:n.map(o=>m("a",{className:o.view===t?r:i,href:o.view,onClick:a=>e.navigate(o.view,a),children:[" ",o.text," "]}))})]})}),qn=Ee("GithubLogo",({size:e})=>(e=e||28,m("a",{href:"https://github.com/asimojs/asidemo",target:"_blank","aria-valuetext":"Link to project's Github page",children:m("svg",{width:e,height:e,viewBox:"0 0 96 98",xmlns:"http://www.w3.org/2000/svg",children:m("path",{className:"fill-current","fill-rule":"evenodd","clip-rule":"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"})})})));const Ze=ie("asidemo.utils.Fetch");async function Kn(e,t){return fetch(e,t)}re.registerService(Ze,()=>Kn);function Xn(){return de.createStore("FetchService",e=>{const t=e.init({networkDisconnection:!1});let n,r=null;return{data:t,async fetch(i,o){return n||(r||(r=re.get(Ze)),n=await r),n(i,o)}}})}re.registerService(dn,Xn);let ue="/";const ze=window.location.pathname;if(ze.length>1){const t=ze.slice(1).indexOf("/");t>-1&&(ue=ze.slice(0,t+2),console.log("%crootPath: %s","color:#2d7bf0",ue))}const Yn=["","team","tasks","404"];function Zn(){return de.createStore("NavService",e=>{const t=e.init({view:"loading",services:{}},{init:function*(r,i){i.maxComputeCount=1;const{id:o,invalidPath404:a}=Ct();n(o,a)}});function n(r,i,o=!1){r==="tasks"?document.title="Asimo demo - tasks":r==="team"?document.title="Asimo demo - team":document.title="Asimo demo",t.view=r,t.invalidPath404=r==="404"?i:"";let a="";const d=window.location.href.match(/(\#|\?).*$/);a=d&&d[0]||a,o&&window.history.pushState({},"",ue+r+a)}return window.onpopstate=()=>{const{id:r,invalidPath404:i}=Ct();n(r,i)},{data:t,navigate(r,i){i&&i.preventDefault(),n(r||"","",!0)}}})}function Ct(){const e=window.location.pathname;if(e.slice(0,ue.length)!==ue)return console.error(`[navservice] Invalid root path: ${e.slice(0,ue.length)}"`),{id:"404",invalidPath404:e};let t=e.slice(ue.length);return t=t.replace(/\/*$/g,""),Yn.includes(t)?{id:t}:{id:"404",invalidPath404:t}}re.registerService(Ut,Zn);async function Qn(e,t){if(e==="/api/team/teamA"){const n={type:"GetTeamResponse",team:{id:"teamA",name:"The A Team",members:[{id:"USR1",firstName:"John (Hannibal)",lastName:"Smith"},{id:"USR2",firstName:"Templeton (Face)",lastName:"Peck"},{id:"USR3",firstName:"H.M. (Howling Mad)",lastName:"Murdock"},{id:"USR4",firstName:"Bosco (B.A.)",lastName:"Baracus"}]}};return new Response(JSON.stringify(n))}else if(e==="/api/tasks/teamA"){const n={type:"GetTasksResponse",tasks:[{id:"T1",description:"Code & Test",completed:!1,createdBy:"USR1"},{id:"T2",description:"Refactor",completed:!1,createdBy:"USR1"},{id:"T3",description:"Deploy",completed:!1,createdBy:"USR1"},{id:"T4",description:"Repeat!",completed:!1,createdBy:"USR1"}]};return new Response(JSON.stringify(n))}else console.log(`Unsupported fetch mock: ${e}`);return fetch(e,t)}re.registerService(Ze,()=>Qn);const er=ie("asidemo.api.GetTeamAPI"),tr=ie("asidemo.api.GetTasksAPI");re.registerGroup([pn,er,Kt],()=>Je(()=>import("./teamBundle-f8f31ba8.js"),[]));re.registerGroup([fn,tr,Xt],()=>Je(()=>import("./tasksBundle-142df267.js"),[]));async function nr(){const e=window.location.search.match(/me=([0-9]+)/);e&&(await Je(()=>import("./index-db8accad.js"),[])).mockEnv.setProfile(parseInt(e[1],0));const t=await re.get(Ut);un(m("div",{className:"text-neutral-600",children:m(Bn,{ns:t})}),document.getElementById("main"))}nr();export{Ze as F,er as G,pn as T,dn as a,Kt as b,fn as c,tr as d,Xt as e,Ee as j,m as o,de as q,rr as u,re as x};
